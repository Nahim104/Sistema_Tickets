= Proyecto Sistema de Tickets v1.2
:toc: left
:toclevels: 4
:icons: font
:source-highlighter: highlightjs

== {icon:code[]} Envió de Tickets por medio de API hacia Redmine

=== {icon:ticket[]} Redmine

image::https://www.redmine.org/attachments/download/3458/redmine_logo_v1.png[Redmine Logo, align="center"]

==== {icon:info[]} Descripción

*Redmine* es un sistema de gestión de proyectos de código abierto y flexible que permite el seguimiento de incidencias (issues/tickets) y la gestión de proyectos. Está construido con Ruby on Rails y proporciona una interfaz web para administrar proyectos, asignar tareas, realizar seguimiento de bugs y solicitudes de funcionalidades.

Redmine incluye características como:

* Gestión de múltiples proyectos
* Sistema flexible de seguimiento de incidencias
* Control de acceso basado en roles
* Integración con sistemas de control de versiones (Git, SVN, etc.)
* Diagramas de Gantt y calendarios
* Notificaciones por email
* API REST para integración con otras aplicaciones

==== {icon:copyright[]} Licencia

Redmine está licenciado bajo la *GNU General Public License v2* (GPLv2), lo que significa que es software libre y de código abierto. Los usuarios tienen la libertad de usar, estudiar, modificar y distribuir el software.

==== {icon:gear[]} Desarrollo

===== {icon:server[]} BACKEND

====== {icon:download[]} Instalación

[source,bash]
----
# Actualizar el sistema
sudo apt update
sudo apt upgrade -y

# Instalar dependencias necesarias
sudo apt install -y build-essential ruby-dev libmysqlclient-dev \
  imagemagick libmagickwand-dev libpq-dev libsqlite3-dev

# Instalar Ruby (si no está instalado)
sudo apt install -y ruby-full

# Instalar Bundler
sudo gem install bundler

# Descargar Redmine
cd /opt
sudo wget https://www.redmine.org/releases/redmine-5.1.0.tar.gz
sudo tar -xzf redmine-5.1.0.tar.gz
sudo mv redmine-5.1.0 redmine
cd redmine

# Instalar las gemas necesarias
sudo bundle install --without development test
----

.Captura de pantalla
image::imagenes/instalacion_backend.png[Instalación Backend, 1000, align="center"]

====== {icon:wrench[]} Configuración

[source,bash]
----
# Configurar la base de datos
cd /opt/redmine/config
sudo cp database.yml.example database.yml
sudo nano database.yml

# Editar para usar SQLite (desarrollo) o MySQL/PostgreSQL (producción)

# Generar token secreto
sudo bundle exec rake generate_secret_token

# Crear la estructura de la base de datos
sudo RAILS_ENV=production bundle exec rake db:migrate

# Cargar datos por defecto
sudo RAILS_ENV=production bundle exec rake redmine:load_default_data

# Configurar permisos
sudo chown -R www-data:www-data /opt/redmine
sudo chmod -R 755 /opt/redmine
----

.Captura de pantalla
image::imagenes/configuracion_backend.png[Configuración Backend, 1000, align="center"]

====== {icon:terminal[]} Ejecución

[source,bash]
----
# Ejecutar Redmine en modo desarrollo
cd /opt/redmine
bundle exec rails server -e production -b 0.0.0.0

# O usando WEBrick
bundle exec ruby bin/rails server webrick -e production

# Para producción, configurar con Passenger o Puma
----

.Captura de pantalla
image::imagenes/ejecucion_backend.png[Ejecución Backend, 1000, align="center"]

====== {icon:check[]} Verificación

[source,bash]
----
# Verificar versión del sistema operativo
cat /etc/debian_version

# Verificar versión de Ruby
ruby -v

# Verificar versión de Redmine
cd /opt/redmine
cat lib/redmine/version.rb | grep VERSION
----

.Captura de pantalla
image::imagenes/verificacion_os_y_app.png[Verificación OS y App, 1000, align="center"]

===== {icon:plug[]} API

image::https://assets.goodfirms.co/glossary/1655457664-api.png[API, align="center"]

====== {icon:info[]} Descripción

*API* (Application Programming Interface) es un conjunto de definiciones y protocolos que permite la comunicación entre diferentes aplicaciones de software. La API REST de Redmine permite a las aplicaciones externas interactuar con Redmine mediante peticiones HTTP estándar (GET, POST, PUT, DELETE).

La API de Redmine utiliza:

* Formato JSON para el intercambio de datos
* Autenticación mediante API Key
* Endpoints para gestionar proyectos, issues, usuarios, etc.

====== {icon:cube[]} Herramientas

* {icon:plug[]} https://marketplace.visualstudio.com/items?itemName=humao.rest-client[REST Client - Extensión de Visual Studio Code]
* Alternativas: https://www.postman.com/[Postman], Insomnia, cURL

====== {icon:list[]} Listado antes de la prueba de envío

.{icon:code[]} Código - list.http
[source,http]
----
### Test API redmine
@key = TU_API_KEY_AQUI
@host = https://tu-servidor-redmine.com
@project = tu-proyecto-id

### List issues
GET {{host}}/projects/{{project}}/issues.json?key={{key}}
Content-Type: application/json
----

.Captura de pantalla
image::imagenes/api_test_01.png[API Test 01, 1000, align="center"]

====== {icon:send[]} Prueba de envío

.{icon:code[]} Código - send.http
[source,http]
----
### Test API redmine
@key = TU_API_KEY_AQUI
@host = https://tu-servidor-redmine.com
@project = tu-proyecto-id

### Send issue
POST {{host}}/issues.json?key={{key}}
Content-Type: application/json

{
  "issue": {
    "project_id": "{{project}}",
    "subject": "Ticket de prueba desde API",
    "description": "Este es un ticket creado mediante la API REST de Redmine",
    "priority_id": 2,
    "tracker_id": 1
  }
}
----

.Captura de pantalla
image::imagenes/api_test_02.png[API Test 02, 1000, align="center"]

====== {icon:list[]} Listado después de la prueba de envío

.{icon:code[]} Código - list.http
[source,http]
----
### Test API redmine
@key = TU_API_KEY_AQUI
@host = https://tu-servidor-redmine.com
@project = tu-proyecto-id

### List issues
GET {{host}}/projects/{{project}}/issues.json?key={{key}}
Content-Type: application/json
----

.Captura de pantalla list.http
image::imagenes/api_test_03.png[API Test 03, 1000, align="center"]

.{icon:ticket[]} Peticiones en Redmine
image::imagenes/api_test_04.png[API Test 04, 1000, align="center"]

===== {icon:code[]} FRONTEND

====== {icon:github[]} Clonación

[source,bash]
----
# Clonar repositorio del proyecto
git clone https://github.com/tu-usuario/proyecto-tickets-redmine.git
cd proyecto-tickets-redmine
----

====== {icon:download[]} Instalación

[source,bash]
----
# Si usas Node.js para servir archivos estáticos
npm install -g http-server

# O si prefieres Python
python3 -m http.server 8080
----

====== {icon:terminal[]} Ejecución

[source,bash]
----
# Navegar al directorio del frontend
cd frontend

# Ejecutar servidor local
http-server -p 8080

# O con Python
python3 -m http.server 8080

# Acceder desde el navegador: http://localhost:8080
----

====== {icon:send[]} Prueba de envío

.Captura de pantalla - App
image::imagenes/app_test_01.png[App Test 01, 1000, align="center"]

====== {icon:list[]} Verificación de envío

.{icon:ticket[]} Peticiones en Redmine
image::imagenes/app_test_02.png[App Test 02, 1000, align="center"]

====== {icon:code[]} Código del App

.fuente/index.html
[source,html]
----
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Tickets - Redmine</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Sistema de Gestión de Tickets</h1>
            <p>Integración con Redmine API</p>
        </header>
        
        <main>
            <section class="form-section">
                <h2>Crear Nuevo Ticket</h2>
                <form id="ticketForm">
                    <div class="form-group">
                        <label for="subject">Asunto:</label>
                        <input type="text" id="subject" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="description">Descripción:</label>
                        <textarea id="description" rows="5" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="priority">Prioridad:</label>
                        <select id="priority">
                            <option value="1">Baja</option>
                            <option value="2" selected>Normal</option>
                            <option value="3">Alta</option>
                            <option value="4">Urgente</option>
                        </select>
                    </div>
                    
                    <button type="submit" class="btn-submit">Enviar Ticket</button>
                </form>
            </section>
            
            <section class="tickets-section">
                <h2>Tickets Recientes</h2>
                <div id="ticketsList"></div>
            </section>
        </main>
    </div>
    
    <script src="app.js"></script>
</body>
</html>
----

.fuente/styles.css
[source,css]
----
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    padding: 20px;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    background: white;
    border-radius: 10px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    overflow: hidden;
}

header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 30px;
    text-align: center;
}

header h1 {
    font-size: 2.5em;
    margin-bottom: 10px;
}

main {
    padding: 30px;
}

.form-section, .tickets-section {
    margin-bottom: 40px;
}

h2 {
    color: #333;
    margin-bottom: 20px;
    font-size: 1.8em;
    border-bottom: 3px solid #667eea;
    padding-bottom: 10px;
}

.form-group {
    margin-bottom: 20px;
}

label {
    display: block;
    margin-bottom: 8px;
    color: #555;
    font-weight: 600;
}

input[type="text"],
textarea,
select {
    width: 100%;
    padding: 12px;
    border: 2px solid #ddd;
    border-radius: 5px;
    font-size: 1em;
    transition: border-color 0.3s;
}

input[type="text"]:focus,
textarea:focus,
select:focus {
    outline: none;
    border-color: #667eea;
}

.btn-submit {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 15px 40px;
    border: none;
    border-radius: 5px;
    font-size: 1.1em;
    cursor: pointer;
    transition: transform 0.2s;
}

.btn-submit:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}

#ticketsList {
    display: grid;
    gap: 15px;
}

.ticket-item {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    border-left: 4px solid #667eea;
    transition: transform 0.2s;
}

.ticket-item:hover {
    transform: translateX(5px);
    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
}

.ticket-subject {
    font-size: 1.3em;
    color: #333;
    margin-bottom: 10px;
    font-weight: 600;
}

.ticket-description {
    color: #666;
    margin-bottom: 10px;
    line-height: 1.6;
}

.ticket-meta {
    display: flex;
    gap: 20px;
    font-size: 0.9em;
    color: #888;
}

.priority {
    padding: 4px 12px;
    border-radius: 20px;
    font-weight: 600;
}

.priority-1 { background: #d4edda; color: #155724; }
.priority-2 { background: #d1ecf1; color: #0c5460; }
.priority-3 { background: #fff3cd; color: #856404; }
.priority-4 { background: #f8d7da; color: #721c24; }

.loading {
    text-align: center;
    padding: 40px;
    color: #667eea;
    font-size: 1.2em;
}

.error {
    background: #f8d7da;
    color: #721c24;
    padding: 15px;
    border-radius: 5px;
    margin-bottom: 20px;
}

.success {
    background: #d4edda;
    color: #155724;
    padding: 15px;
    border-radius: 5px;
    margin-bottom: 20px;
}
----

.fuente/app.js
[source,javascript]
----
// Configuración de la API de Redmine
const API_CONFIG = {
    host: 'https://tu-servidor-redmine.com',
    apiKey: 'TU_API_KEY_AQUI',
    projectId: 'tu-proyecto-id'
};

// Función para mostrar mensajes
function showMessage(message, type = 'success') {
    const messageDiv = document.createElement('div');
    messageDiv.className = type;
    messageDiv.textContent = message;
    
    const main = document.querySelector('main');
    main.insertBefore(messageDiv, main.firstChild);
    
    setTimeout(() => messageDiv.remove(), 5000);
}

// Función para cargar tickets
async function loadTickets() {
    const ticketsList = document.getElementById('ticketsList');
    ticketsList.innerHTML = '<div class="loading">Cargando tickets...</div>';
    
    try {
        const response = await fetch(
            `${API_CONFIG.host}/projects/${API_CONFIG.projectId}/issues.json?key=${API_CONFIG.apiKey}`
        );
        
        if (!response.ok) throw new Error('Error al cargar tickets');
        
        const data = await response.json();
        displayTickets(data.issues);
    } catch (error) {
        ticketsList.innerHTML = `<div class="error">Error: ${error.message}</div>`;
    }
}

// Función para mostrar tickets
function displayTickets(tickets) {
    const ticketsList = document.getElementById('ticketsList');
    
    if (tickets.length === 0) {
        ticketsList.innerHTML = '<p>No hay tickets disponibles</p>';
        return;
    }
    
    ticketsList.innerHTML = tickets.map(ticket => `
        <div class="ticket-item">
            <div class="ticket-subject">#${ticket.id} - ${ticket.subject}</div>
            <div class="ticket-description">${ticket.description || 'Sin descripción'}</div>
            <div class="ticket-meta">
                <span class="priority priority-${ticket.priority.id}">
                    ${ticket.priority.name}
                </span>
                <span>Estado: ${ticket.status.name}</span>
                <span>Creado: ${new Date(ticket.created_on).toLocaleDateString()}</span>
            </div>
        </div>
    `).join('');
}

// Función para enviar ticket
async function submitTicket(event) {
    event.preventDefault();
    
    const formData = {
        issue: {
            project_id: API_CONFIG.projectId,
            subject: document.getElementById('subject').value,
            description: document.getElementById('description').value,
            priority_id: parseInt(document.getElementById('priority').value),
            tracker_id: 1
        }
    };
    
    try {
        const response = await fetch(
            `${API_CONFIG.host}/issues.json?key=${API_CONFIG.apiKey}`,
            {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            }
        );
        
        if (!response.ok) throw new Error('Error al crear ticket');
        
        showMessage('Ticket creado exitosamente', 'success');
        document.getElementById('ticketForm').reset();
        loadTickets();
    } catch (error) {
        showMessage(`Error: ${error.message}`, 'error');
    }
}

// Event listeners
document.getElementById('ticketForm').addEventListener('submit', submitTicket);

// Cargar tickets al iniciar
loadTickets();
----

==== {icon:gear[]} Gestión

===== {icon:book[]} Proyecto 1/2

====== {icon:plus[]} Creación

.Captura de pantalla
image::imagenes/creacion_de_proyecto.png[Creación de Proyecto, 1000, align="center"]

===== {icon:ticket[]} Peticiones

====== {icon:eye[]} Ver

.Captura de pantalla
image::imagenes/ver_peticiones.png[Ver Peticiones, 1000, align="center"]

====== {icon:edit[]} Modificar

.Captura de pantalla
image::imagenes/modificar_peticiones.png[Modificar Peticiones, 1000, align="center"]

====== {icon:star[]} Priorizar

.Captura de pantalla
image::imagenes/priorizar_peticiones.png[Priorizar Peticiones, 1000, align="center"]

====== {icon:wrench[]} Trabajo

.Captura de pantalla
image::imagenes/trabajo_peticiones.png[Trabajo Peticiones, 1000, align="center"]

====== {icon:trash[]} Eliminar

.Captura de pantalla
image::imagenes/eliminar_peticiones.png[Eliminar Peticiones, 1000, align="center"]

===== {icon:book[]} Proyecto 2/2

====== {icon:edit[]} Modificar

.Captura de pantalla
image::imagenes/modificar_proyecto.png[Modificar Proyecto, 1000, align="center"]

====== {icon:trash[]} Eliminar

.Captura de pantalla
image::imagenes/eliminar_proyecto.png[Eliminar Proyecto, 1000, align="center"]

=== {icon:users[]} Autor

[cols="1,2"]
|===
| Cuenta | Nombre

| {icon:hashtag[]} 12141186
| {icon:user[]} Ingrid Carolina Hernandez Inestroza
| {icon:hashtag[]} 000000001
| {icon:user[]} nombre
| {icon:hashtag[]} 010101010
| {icon:user[]} Nombre 
|===

=== {icon:book[]} Referencias

* {icon:link[]} https://www.redmine.org/[Sitio Oficial de Redmine]
* {icon:link[]} https://www.redmine.org/projects/redmine/wiki/Rest_api[Documentación API REST de Redmine]
* {icon:link[]} https://docs.asciidoctor.org/[Asciidoctor Documentation Home]
* {icon:link[]} https://developer.mozilla.org/es/docs/Web/API/Fetch_API[MDN Web Docs - Fetch API]

[.text-center]
*Desarrollado* para *Gobernabilidad de Tecnologías de Información | UNITEC*